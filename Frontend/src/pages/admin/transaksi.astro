---
// Admin Transaksi
import Layout from '../../layouts/Layout.astro';
import { apiService } from '../../lib/apiService';
import '../../css/admin.css';

const transactions = await apiService.getAdminOrders() as any[];
---

<Layout title="Data Transaksi - TUKO" isAdmin={true}>
  <div class="admin-container">
    <aside class="admin-sidebar">
      <nav class="admin-menu">
        <a href="/admin/dashboard" class="menu-item">
          <span>Beranda</span>
        </a>
        <a href="/admin/transaksi" class="menu-item active">
          <span>Transaksi</span>
        </a>
        <a href="/admin/kasir" class="menu-item">
          <span>Kasir</span>
        </a>
        <a href="/admin/user" class="menu-item">
          <span>Pengguna</span>
        </a>
        <a href="/admin/product" class="menu-item">
          <span>Produk</span>
        </a>
        <a href="/admin/kategori" class="menu-item">
          <span>Kategori</span>
        </a>
      </nav>
      <div class="sidebar-footer">
        <a href="/" class="logout-btn">
          <span>Keluar</span>
        </a>
      </div>
    </aside>

    <main class="admin-main">
      <div class="admin-header">
        <h1>Data Transaksi</h1>
      </div>

      <div class="transactions-section">
        <div class="table-scroll-wrapper">
          <div class="table-container">
            <div class="table-header dashboard-grid">
              <div class="col-id">ID</div>
              <div class="col-date">Tanggal</div>
              <div class="col-customer">Pelanggan</div>
              <div class="col-cashier">Kasir</div>
              <div class="col-total">Total</div>
              <div class="col-method">Metode Pembayaran</div>
              <div class="col-bank">Bank</div>
              <div class="col-receipt">Nomor Nota</div>
            </div>
            
            <div class="table-body">
              {transactions.map((tr: any) => (
                <div class="transaction-card dashboard-grid">
                  <div class="col-id">#{tr.id}</div>
                  <div class="col-date">
                    {new Date(tr.tanggal).toLocaleDateString('id-ID', {
                      day: 'numeric',
                      month: 'long',
                      year: 'numeric'
                    })}
                  </div>
                  <div class="col-customer">{tr.pelanggan || '-'}</div>
                  <div class="col-cashier">{tr.kasir || '-'}</div>
                  <div class="col-total">
                    {new Intl.NumberFormat('id-ID', {
                      style: 'currency',
                      currency: 'IDR',
                      minimumFractionDigits: 0
                    }).format(Number(tr.total || 0))}
                  </div>
                  <div class="col-method">{tr.metode_pembayaran || '-'}</div>
                  <div class="col-bank">{tr.bank || '-'}</div>
                  <div class="col-receipt">{tr.nomor_nota || '-'}</div>
                </div>
              ))}
              {transactions.length === 0 && (
                <div class="transaction-card empty dashboard-grid">
                  <span>Belum ada transaksi</span>
                </div>
              )}
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
</Layout>
